Search.setIndex({"alltitles": {"An example cell": [[10, "an-example-cell"]], "Autograd": [[3, "autograd"]], "Backward Pass": [[3, "backward-pass"]], "Basic NN Components": [[6, "basic-nn-components"]], "Basics": [[8, null]], "Breakpoints": [[4, "breakpoints"]], "CUDA From Scratch": [[8, null]], "CUDA-gdb": [[4, "cuda-gdb"]], "Citations": [[9, "citations"]], "Code blocks and outputs": [[11, "code-blocks-and-outputs"]], "Compile the CUDA file": [[4, "compile-the-cuda-file"]], "Content with notebooks": [[11, null]], "Create a notebook with MyST Markdown": [[10, "create-a-notebook-with-myst-markdown"]], "Cuda Memory Hierarchy and Thread Management": [[5, null]], "Differences between tensor wrapper and extending pytorch": [[3, "differences-between-tensor-wrapper-and-extending-pytorch"]], "Example: merge the kv cache": [[7, "example-merge-the-kv-cache"]], "Forward Pass": [[3, "forward-pass"]], "Gradient": [[3, "gradient"]], "Initialize a tensor": [[2, "initialize-a-tensor"]], "Learn more": [[9, "learn-more"]], "List the cuda source codes": [[4, "list-the-cuda-source-codes"]], "Markdown + notebooks": [[11, "markdown-notebooks"]], "Markdown Files": [[9, null]], "Memory structure": [[3, "memory-structure"]], "My header": [[0, null]], "MyST markdown": [[11, "myst-markdown"]], "Neural Network Fundamentals": [[6, null]], "Notebooks with MyST Markdown": [[10, null]], "Operations on Tensors": [[2, "operations-on-tensors"]], "Pytorch Basics": [[2, null]], "Pytorch Internals": [[1, null]], "Pytorch internals": [[3, null]], "Quickly add YAML metadata for MyST Notebooks": [[10, "quickly-add-yaml-metadata-for-myst-notebooks"]], "RUN CUDA Files": [[4, null]], "References:": [[1, "references"]], "Run the program": [[4, "run-the-program"]], "Sample Roles and Directives": [[9, "sample-roles-and-directives"]], "Tensor extensions": [[3, "tensor-extensions"]], "Tensor low-level Operations": [[3, "tensor-low-level-operations"]], "Tensors": [[2, "tensors"]], "The architecture": [[5, "the-architecture"]], "Thread Management": [[5, "thread-management"]], "Welcome to your Jupyter Book": [[8, null]], "What is MyST?": [[9, "what-is-myst"]], "others": [[8, null]], "torch.scatter_reduce_ and torch.gather": [[7, null]]}, "docnames": ["docs/0_basics/0_test", "docs/0_basics/pytorch", "docs/0_basics/pytorch_basics", "docs/0_basics/pytorch_internals", "docs/1_cuda_from_scratch/start", "docs/1_cuda_from_scratch/thread_memory_understanding", "docs/2_LLM_cheatsheet/NN_Fundamentals", "docs/others/torch.scatter&gather", "intro", "markdown", "markdown-notebooks", "notebooks"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9}, "filenames": ["docs/0_basics/0_test.md", "docs/0_basics/pytorch.md", "docs/0_basics/pytorch_basics.ipynb", "docs/0_basics/pytorch_internals.ipynb", "docs/1_cuda_from_scratch/start.md", "docs/1_cuda_from_scratch/thread_memory_understanding.md", "docs/2_LLM_cheatsheet/NN_Fundamentals.ipynb", "docs/others/torch.scatter&gather.ipynb", "intro.md", "markdown.md", "markdown-notebooks.md", "notebooks.ipynb"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [0, 3, 4, 9, 10, 11], "0": [2, 3, 4, 6, 7, 11], "01": 6, "0399": 2, "0402": [], "044715": 6, "05": 1, "0x0000000000000000000000000055": 4, "0x7fffee7dd000": 4, "0x7fffeffff000": 4, "0x7ffff5bff000": 4, "0xaee0": 4, "1": [1, 2, 3, 4, 6, 7, 11], "10": [4, 6, 7, 11], "100": 11, "1019": [], "11": 7, "12": 7, "13": [], "130": 7, "1382": [], "147": 3, "19680801": 11, "1e": 7, "2": [2, 3, 4, 6, 7, 10, 11], "20": 7, "2011": [], "2014": [], "2019": 1, "21": [], "2415": [], "2428436": 4, "2428441": 4, "2428442": 4, "2428443": 4, "2428450": 4, "2693": 2, "275": 3, "294": 3, "3": [2, 3, 4, 6, 7, 11], "30": 7, "32": 5, "343": 3, "3906": [], "4": [2, 3, 4, 7, 10, 11], "40": 7, "4081": 2, "4899": [], "5": [4, 6, 7, 11], "50": 7, "6": [4, 6, 7], "60": 7, "6024": [], "64": 7, "6632": 2, "7": [3, 4, 7], "70": 7, "7994": [], "8": [4, 7], "80": 7, "81": 3, "8662": [], "9": [4, 7], "9801": [], "9815": [], "9969": [], "A": [3, 5, 7], "As": 11, "At": 3, "But": 11, "For": [9, 11], "If": [3, 5, 10], "In": [3, 4, 11], "It": [3, 8, 9], "No": 11, "That": 10, "The": [3, 9, 10], "There": 11, "To": 3, "With": [2, 10], "__global__": 4, "__init__": 6, "__syncthread": 5, "_conversion_method_templ": 3, "_mkldnn": 3, "_multiarray_umath": 3, "_rate": 3, "_subclass": 3, "_weight": 3, "_work": 3, "a_len": 7, "a_norm": 7, "about": [3, 9, 10, 11], "abstract": 3, "acceler": 5, "accept": 9, "access": 5, "accord": 7, "action": 3, "activ": [4, 5, 6], "ad": 3, "add": 3, "add_": 11, "affect": 3, "after": 4, "al": [], "align": 11, "all": [3, 5, 7, 9, 10], "allow": [3, 5, 9], "along": 7, "also": [3, 9, 10, 11], "alwai": 3, "amax": 7, "amin": 7, "among": 5, "an": [3, 7, 9], "anaconda": 3, "ani": [3, 8, 10], "anoth": [2, 3, 4, 5], "appli": 3, "applic": 5, "appropri": [3, 5], "ar": [5, 6, 9, 10], "arang": 6, "argument": 7, "around": 3, "arrai": [2, 11], "ask": 3, "assign": 5, "asynchron": 5, "auditori": [], "australia": [], "automat": 3, "avail": 5, "avoid": 5, "ax": 11, "b": 7, "b_len": 7, "b_norm": 7, "back": 3, "backend": 3, "base": [3, 5, 7, 10], "basic": 5, "befor": 5, "begin": 11, "behavior": 3, "being": [5, 9], "better": 5, "between": [5, 7], "bia": 6, "bib": 9, "bibliographi": 9, "bibtex": 9, "bigger": 3, "block": [4, 5, 10], "blockdim": 4, "blockidx": 4, "blog": 1, "book": [9, 10, 11], "both": 9, "box": 9, "branch": 5, "break": 4, "brian": [], "bridg": 5, "brisban": [], "bsz": 7, "build": [3, 9], "built": [3, 10], "bundl": 8, "c": 3, "cach": 5, "call": [3, 9, 11], "can": [3, 5, 9, 10, 11], "cartesian": 3, "case": 3, "cell": 11, "central": 3, "cerr": 4, "chain": 3, "chang": 3, "chapter_1": 4, "check": [8, 11], "child": 4, "chip": 5, "choos": 3, "chosen": 3, "christoph": [], "citat": 0, "cite": 9, "clamp_min": 7, "class": [3, 6], "close": 5, "cm": 11, "cmap": 11, "code": [5, 10], "cognit": [], "cold": 11, "collect": 7, "color": 11, "com": 1, "command": [4, 10], "commonmark": 9, "commun": 5, "compar": 5, "compil": 8, "complet": [4, 5], "compon": 5, "comput": [3, 5, 7], "condit": 5, "confer": [], "consist": 5, "constant": 2, "contain": [4, 7], "content": [8, 9, 10], "continu": [4, 5], "control": 5, "convert": 10, "coolwarm": 11, "cooper": 5, "copi": 2, "core": [3, 5], "correct": 3, "cortex": [], "cosin": 7, "count": 7, "count_per_group": 7, "cout": 4, "cpp": 3, "cpu": 3, "creat": [3, 11], "criterion": 3, "csrc": 3, "cu": 4, "cuda": 3, "cuda_from_scratch": 4, "cuda_runtim": 4, "cudadevicesynchron": [4, 5], "cudageterrorstr": 4, "cudagetlasterror": 4, "cudasuccess": 4, "current": 4, "custom_lin": 11, "cycler": 11, "d": [4, 5, 10], "data": [2, 3, 4, 5, 7, 11], "de": [], "debug": 4, "deep": [3, 5], "def": 6, "default": [3, 10], "defin": [3, 10], "definit": 3, "degrad": 5, "dens": 3, "depend": [3, 9], "depth": 8, "deriv": 3, "descript": 5, "design": 5, "detach": [4, 6], "detail": [4, 10], "determin": 3, "dev": 4, "devic": [3, 4, 7], "differ": 9, "difficulti": 3, "dim": 7, "dimens": 7, "dimension": 3, "direct": [7, 10], "dispatch": [3, 5], "displai": 10, "diverg": 5, "dll": 3, "dnn": 3, "do": [3, 9, 11], "document": [2, 8, 9, 10, 11], "doe": 8, "doesn": 3, "dollar": 11, "dtype": [2, 3, 6, 7], "due": 5, "dure": 5, "dx": 3, "dy": 3, "dynam": 3, "dz": 3, "e": [3, 5], "each": [3, 4, 5, 7], "easi": 3, "ecosystem": 9, "effici": 5, "eleg": 3, "element": [3, 7], "elimin": 2, "els": [4, 5], "emb": 11, "enabl": 4, "end": 11, "endl": 4, "engin": [], "ensur": [3, 6], "env": 3, "error": [4, 6], "escap": 11, "et": [], "etc": [3, 11], "even": 4, "evid": [], "examin": 4, "exampl": [3, 9, 11], "except": 3, "execut": [4, 5, 10], "exist": 3, "exit": 4, "exp": 7, "expand": 7, "exponenti": 5, "extens": 9, "extra": 3, "ezyang": 1, "f": [3, 6, 7], "fail": 3, "fals": 7, "fast": 5, "faster": 3, "featur": 3, "feel": 8, "fernando": [], "few": 8, "fewer": 5, "fig": 11, "figsiz": [6, 11], "figur": 6, "file": [5, 8, 10], "final": 3, "finish": 5, "first": 3, "fix": 11, "flavor": 9, "float": [2, 7], "float32": [3, 6], "float64": 3, "flow": 3, "focu": 4, "follow": [9, 10], "fork": 4, "forward": 6, "frac": 3, "frequent": 5, "from": [2, 4, 5, 7, 11], "from_numpi": 2, "frontier": [], "full": [2, 3, 7], "full_tensor": 2, "fulli": 3, "function": [3, 5, 6, 7, 9], "functional_tensor": 3, "g": [3, 4, 5], "gather": 8, "gaussian": 6, "gdb": 8, "gelu": 6, "get": [3, 7, 9, 10], "give": 8, "given": [3, 7], "global": 5, "gnu": 4, "go": [7, 8], "goal": 7, "good": 3, "gpu": [3, 5], "grad": 3, "granger": [], "graph": 3, "grid": [4, 5, 6], "griddim": 4, "group": [5, 7], "group_idx_per_a_idx": 7, "group_idx_per_a_v": 7, "group_max": 7, "guid": 11, "h": 4, "ha": 5, "happen": 3, "hard": 3, "hardwar": 5, "have": [7, 10], "hdhpk14": [], "head_dim": 7, "header": [], "heer": [], "hello": 4, "hello_world": 4, "help": [5, 9], "here": [0, 9, 11], "hide": 5, "hierarch": 5, "higher": 5, "highest": 5, "hit": 4, "hold": 3, "holdgraf": [], "holdgraf_evidence_2014": 9, "home": 4, "host": [4, 5], "hot": 11, "how": [3, 8, 10], "html": 11, "http": 1, "huhu": 4, "human": [], "hunter": [], "i": [0, 3, 4, 5, 7, 8, 10, 11], "id": 5, "idx": [4, 7], "ii": 11, "imag": 11, "implement": 3, "import": [2, 3, 5, 6, 7, 11], "includ": [3, 4, 10, 11], "include_self": 7, "independ": 5, "index": [3, 7], "indic": 7, "inf": [2, 7], "inferior": 4, "info": 4, "inform": [3, 8, 10, 11], "init": 10, "initi": 3, "inlin": 9, "input": [3, 7, 9], "input_dim": 6, "insert": 9, "insid": [3, 5], "instanc": 5, "instruct": [5, 10], "int": 4, "int32": 3, "int8": 3, "interact": 11, "intern": 8, "invoc": 4, "involv": 3, "ion": 11, "iostream": 4, "ipynb": 9, "item": 3, "its": [3, 5], "itself": 3, "j": [3, 7], "john": [], "jupyt": [9, 10, 11], "jupyterbook": 9, "jupytext": 10, "just": [3, 9], "k": 3, "keep": 11, "keepdim": 7, "kei": 7, "kernel": [4, 5, 10], "kind": 9, "knight": [], "knowledg": 3, "l1": 5, "l2": 5, "la_": 11, "label": [0, 3], "laid": 3, "lane": 4, "languag": 9, "larger": 5, "last": 11, "latenc": 5, "launch": [4, 5], "layer": 3, "layout": 3, "ld": 5, "lead": 5, "learn": [3, 5], "legend": 11, "let": [4, 10], "level": 5, "lib": [3, 4], "librari": 4, "libthread_db": 4, "like": [3, 9, 10], "line": [4, 9, 10, 11], "line2d": 11, "linear": 6, "linearlay": 6, "linspac": 11, "linux": 4, "littl": 3, "ll": 9, "llm": 3, "load": [3, 5], "local": 5, "locat": 5, "log": 3, "logic": 3, "logspac": 11, "loss": 3, "lot": [9, 11], "low": [], "lw": 11, "lwp": 4, "mai": 3, "main": [4, 5], "major": [3, 8], "make": [3, 11], "mani": [9, 10], "markdown": [], "markdownfil": 10, "markedli": 9, "marker": 6, "markup": 9, "mask": 4, "math": [6, 11], "mathmat": 5, "matmul": 6, "matplotlib": [6, 11], "matrix": 5, "max": 7, "maximum": 7, "mbox": 11, "md": [9, 10], "mean": [7, 11], "mechan": 3, "medium": 11, "member": 3, "memori": 2, "metadata": 3, "minim": 5, "mkl": 3, "mm": 3, "mode": 4, "model": [3, 5], "modul": [6, 11], "modulenotfounderror": 11, "more": [3, 5, 8, 10, 11], "moreov": 9, "most": [3, 9, 11], "mp": 3, "much": 3, "multipl": [3, 5, 7], "must": [7, 9], "my": 3, "my_packag": 4, "mytensor": 3, "n": [2, 4, 11], "name": [3, 11], "nbackward": 3, "need": [3, 5, 10], "neurosci": [], "new": [3, 4], "nifti": 0, "nn": 7, "none": 7, "norm": 7, "normal": [3, 4], "note": 9, "notebook": 9, "np": [2, 11], "np_arrai": 2, "num_head": 7, "number": [5, 7], "numpi": [2, 3, 6, 11], "nvcc": 4, "o": [4, 6], "o0": 4, "o3": 4, "object": 3, "off": [5, 8, 9, 10], "offici": 2, "old": 3, "onc": 5, "one": [3, 5, 9], "ones": [2, 7], "ones_lik": [2, 7], "ones_tensor": 2, "onli": 3, "oper": [5, 7], "optim": [3, 5], "org": 9, "organ": [3, 5], "other": [3, 5, 10], "our": 3, "out": [3, 7, 8, 11], "output": [3, 7, 10], "output_dim": 6, "over": 7, "overlap": 5, "overview": 9, "own": 5, "packag": 3, "page": [8, 9, 10], "paramet": [3, 6], "parent": 4, "partial": 3, "particular": 8, "particularli": 5, "paslei": [], "path": [5, 10], "per": [4, 5, 7], "perez": [], "perform": [3, 5], "pgh11": [], "physic": 3, "pi": 6, "plot": [6, 11], "plt": [6, 11], "pointer": 3, "posit": [3, 7], "post": 11, "pow": 6, "power": 9, "precis": 3, "predict": [], "presenc": 10, "print": [2, 3, 4, 7, 10], "printf": 4, "privat": 5, "proceed": 5, "process": [4, 5], "prod": 7, "product": [3, 6], "prop_cycl": 11, "properli": 9, "properti": 3, "provid": 5, "pull": 7, "purpos": 9, "push": 7, "put": 3, "py": 3, "pyplot": [6, 11], "python": 3, "pytorch": 8, "qint8": 3, "quantiz": 3, "ramsai": [], "rand": [2, 7], "rand_lik": 2, "rand_tensor": 2, "randn": [6, 11], "random": [2, 11], "rang": 11, "rate": 3, "rcparam": 11, "reach": 4, "read": 7, "readi": 5, "recent": 11, "reduc": [5, 7], "reduct": 7, "refer": 9, "referec": 2, "regard": 3, "regist": 5, "regular": 9, "releas": 4, "relev": 3, "render": 9, "repres": 5, "reproduc": 11, "requires_grad": 3, "resourc": 5, "respect": 3, "respons": 5, "rest": 10, "retain_grad": 3, "return": [4, 5, 6], "robert": [], "root": 5, "row": 3, "rule": 3, "run": [8, 10], "runner": 3, "runtim": 5, "same": [2, 3, 5, 7, 9], "sampl": [8, 11], "scatter": 7, "scatter_reduc": 7, "scatter_reduce_": 8, "schedul": 5, "scienc": [], "scientif": [], "score": 7, "second": 3, "see": [8, 9, 10, 11], "seed": 11, "select": 5, "self": 6, "send": 5, "serial": 5, "serv": [5, 9], "sfu": 5, "shape": [2, 3, 7], "share": [2, 5], "should": [7, 10], "show": [6, 8, 9, 10], "shown": 4, "sign": 11, "similar": [7, 9], "simpl": [3, 9], "simultan": 5, "singl": 5, "site": 3, "size": 3, "slight": 9, "slope": 3, "slower": [3, 5], "sm": [4, 5], "small": [5, 8, 9], "smaller": 3, "smallest": 5, "so": [3, 4, 10], "softmax": 7, "some": [0, 8, 9, 11], "someth": 3, "sourc": 7, "space": [3, 5], "span": 9, "spars": 3, "sparse_coo": 3, "sparse_csr": 3, "sparse_grad": 7, "special": [5, 9], "specif": [3, 9], "speed": 3, "sphinx": 9, "spot": 7, "sqrt": 6, "squar": 5, "src": 7, "st": 5, "stai": 5, "stall": 5, "stand": 9, "start": [4, 9, 10], "starter": 9, "state": 11, "statement": 5, "statu": 4, "std": 4, "step": 3, "still": 4, "store": [3, 5, 9], "stride": 3, "structur": [8, 9], "subplot": 11, "successfulli": 4, "sum": 7, "super": 6, "support": [3, 10], "sure": 11, "switch": [4, 5], "synchron": 5, "syntax": 9, "t": [3, 11], "tanh": 6, "tell": 3, "temporari": 5, "tensor": [5, 6, 7], "tensor_numpi": 3, "tex": 11, "text": [0, 9, 10], "th": 4, "thei": 9, "them": 5, "therefor": 5, "thi": [3, 4, 5, 8, 9, 10, 11], "thing": 10, "those": [3, 9], "thread": 4, "threadidx": 4, "three": 3, "through": [3, 5], "time": 3, "titl": 6, "tool": 9, "top": 10, "topic": 8, "torch": [2, 3, 6, 8], "traceback": 11, "track": 3, "trade": 5, "train": 3, "transfer": 5, "transpos": 7, "treat": 10, "trigger": 3, "trigonometr": 5, "triniti": 3, "true": [3, 6, 7], "two": [3, 7, 9, 10], "type": [3, 5, 8], "underli": 2, "understand": 10, "uniqu": [3, 5], "unit": [3, 5, 6], "unsqueez": 7, "until": 5, "updat": 3, "us": [3, 4, 5, 6, 9, 10], "userwarn": 3, "util": [3, 5], "valu": [2, 7], "variabl": [3, 5], "variat": 9, "variou": 3, "void": 4, "wa": 4, "wait": 5, "want": [3, 11], "warp": [4, 5], "we": [3, 4, 5], "weight": [3, 6, 7], "weight_per_a": 7, "weight_sum_per_group": 7, "weighted_a_per_group": 7, "weighted_mean_a_per_group": 7, "weighted_sum_a_per_group": 7, "well": [8, 11], "wendi": [], "what": [3, 7], "when": [3, 5, 9, 10], "where": [3, 7], "wherea": 9, "whether": 9, "which": [3, 5, 7, 10], "while": [3, 5], "why": 5, "within": 5, "work": [3, 11], "world": 4, "wrap": 3, "wrapper": [], "write": [3, 7, 9, 10], "written": [9, 10], "x": [3, 4, 6, 7], "x86_64": 4, "x_data": 2, "x_np": 2, "x_one": 2, "x_rand": 2, "xla": 3, "xlabel": 6, "x\u00b2": 3, "y": [3, 6, 7], "y_pred": 3, "y_true": 3, "ylabel": 6, "you": [3, 8, 9, 10, 11], "your": [3, 9, 10, 11], "z": 3, "zero": [2, 6, 7], "zeros_lik": 7, "zeros_tensor": 2, "\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u6a21\u5757": 3}, "titles": ["My header", "Pytorch Internals", "Pytorch Basics", "Pytorch internals", "RUN CUDA Files", "Cuda Memory Hierarchy and Thread Management", "Neural Network Fundamentals", "torch.scatter_reduce_ and torch.gather", "Welcome to your Jupyter Book", "Markdown Files", "Notebooks with MyST Markdown", "Content with notebooks"], "titleterms": {"The": 5, "add": 10, "an": 10, "architectur": 5, "autograd": 3, "backward": 3, "basic": [2, 6, 8], "between": 3, "block": 11, "book": 8, "breakpoint": 4, "cach": 7, "cell": 10, "citat": 9, "code": [4, 11], "compil": 4, "compon": 6, "content": 11, "creat": 10, "cuda": [4, 5, 8], "differ": 3, "direct": 9, "exampl": [7, 10], "extend": 3, "extens": 3, "file": [4, 9], "forward": 3, "from": 8, "fundament": 6, "gather": 7, "gdb": 4, "gradient": 3, "header": 0, "hierarchi": 5, "i": 9, "initi": 2, "intern": [1, 3], "jupyt": 8, "kv": 7, "learn": 9, "level": 3, "list": 4, "low": 3, "manag": 5, "markdown": [9, 10, 11], "memori": [3, 5], "merg": 7, "metadata": 10, "more": 9, "my": 0, "myst": [9, 10, 11], "network": 6, "neural": 6, "nn": 6, "notebook": [10, 11], "oper": [2, 3], "other": 8, "output": 11, "pass": 3, "program": 4, "pytorch": [1, 2, 3], "quickli": 10, "refer": 1, "role": 9, "run": 4, "sampl": 9, "scatter_reduce_": 7, "scratch": 8, "sourc": 4, "structur": 3, "tensor": [2, 3], "thread": 5, "torch": 7, "two": [], "welcom": 8, "what": 9, "wrapper": 3, "yaml": 10, "your": 8}})